bbc.fmtj.utils.createObject("bbc.fmtj.apps.slideshow");gloader.load(["glow","1","glow.anim","glow.dom","glow.events"],{async:true,onLoad:function(d){var c;switch(bbc.fmtj.page.siteToServe.toLowerCase()){case"newyddion":c="cy";break;case"naidheachdan":c="gd";break;default:c="en";}var b={en:{NEXT_IMAGE:"Next image",PREVIOUS_IMAGE:"Previous image",START:"Start",PAUSE:"Pause"},cy:{NEXT_IMAGE:"Llun nesaf",PREVIOUS_IMAGE:"Llun blaenorol",START:"Dechrau",PAUSE:"Saib"},gd:{NEXT_IMAGE:"An Ath Dhealbh",PREVIOUS_IMAGE:"Dealbh roimhe",START:"TÃ²isich",PAUSE:"Fan"}};var a=b[c];bbc.fmtj.apps.slideshow=(function(){var j={};var g=2;var f=466;var i=260;var h=60;var k=bbc.fmtj.utils.prefixUrl("/shared/img/000000.gif");return{createSlideShow:function(n){var m=d.dom.get("#"+n.containerId).length;if(!m){return;}var l=new e(n);j[n.containerId]=l;if(typeof n.callback=="function"){n.callback(l);}},removeSlideShow:function(m){if(!(m instanceof e)){return;}var l=m.getContainer().attr("id");if(!j[l]){return;}m.clear();delete j[l];}};function e(V){var r=this;var aj=V.containerId;var q=W().clone();var p=V.images;var I=(typeof V.showNav=="boolean"?V.showNav:true);var Y=(typeof V.width=="number"?V.width:f);var Z=(typeof V.height=="number"?V.height:i);var O=(typeof V.overlayHeight=="number"?V.overlayHeight:h);var ae=(typeof V.slideShowInterval=="number"?(V.slideShowInterval*1000):5000);var D=(typeof V.crossFadeInterval=="number"?V.crossFadeInterval:2);var aa=(typeof V.hideMaskTimeout=="number"?(V.hideMaskTimeout*1000):1000);var ab=(typeof V.autoPlay=="boolean"?V.autoPlay:true);var ai=!ab;var x=0;var H,U;var C=null;var s=null;var J=null;var u=null;this.addLiveItems=af;this.refreshItems=w;this.getContainer=W;this.getOriginalContainer=G;this.getSlideShowHeight=B;this.setOverlayHeight=m;this.getOverlayHeight=L;this.getSlideShowImagesCount=ac;this.getSlideShowImage=X;this.play=M;this.pause=l;this.isPaused=ah;this.isAutoPlay=o;this.goToSlide=ad;this.playFromSlide=t;this.getSlideNumberCurrent=N;this.getSlideNumberNext=al;this.getSlideNumberPrevious=E;this.clear=S;var ak=V.userControlsRenderer||y;d.ready(ag);function ah(){return ai;}function o(){return ab;}function W(){return d.dom.get("#"+aj);}function G(){return q;}function al(){return(x+1);}function B(){return Z;}function m(am){O=am;}function L(){return O;}function ac(){return p.length;}function X(am){return p[am];}function af(am){p.unshift(am);return null;}function w(ao,ap){var an=this;var am=ao.images;am.reverse();R.call(an,am,function(){Q.call(an,am,function(){P.call(an,function(){if(typeof ap==="function"){ap();}});});});}function R(am,an){window.setTimeout(function(){var ar;var ap;for(var aq=0;aq<p.length;aq++){ar=p[aq].src;ap=-1;for(var ao=am.length-1;ao>=0;ao--){if(am[ao].src==ar){ap=ao;break;}}if(ap>=0){am.splice(ap,1);}else{p[aq].marked_for_delete=true;if(x==aq){x=0;}}}if(typeof an==="function"){an();}},0);}function Q(am,an){window.setTimeout(function(){for(var ao=0;ao<am.length;ao++){p.unshift(am[ao]);}if(typeof an==="function"){an();}},0);}function P(am){window.setTimeout(function(){for(var an=p.length-1;an>=0;an--){if(p[an].marked_for_delete){p.splice(an,1);}}if(typeof am==="function"){am();}},0);}function N(){if(null!==J){return al();}if(0===x){return p.length;}return x;}function E(){var am=x-1;if(am===0){am=p.length;}else{if(-1===am){am=p.length-1;}}return am;}function S(){l();z();F();W().replaceWith(G());}function M(an){var am=((an&&("number"==typeof an.interval))?(an.interval*1000):ae);ai=false;C=window.setTimeout(v,am);}function v(){var am=W();var ao=d.anim.css(U,D,{opacity:{to:1}},d.tweens.easeOut());var an=d.anim.css(H,D,{opacity:{to:0}},d.tweens.easeIn());J=new d.anim.Timeline([[an],[ao],[A]]);u=d.events.addListener(J,"complete",function(){x=(++x%p.length);H.css("z-index",0);U.css("z-index",1);var ap=x;H.get("img").attr("src",k).attr("alt","").attr("src",bbc.fmtj.utils.prefixUrl(p[ap].src)).attr("alt",p[ap].alt);n();z();if(!ai){M();}});J.start();}function A(am){var an=(am!==undefined?am:x);d.events.fire(r,"slideChange",{currentImageIndex:an});}function l(){ai=true;window.clearTimeout(C);C=null;}function z(){window.clearTimeout(C);C=null;if(null===J){return;}J.stop();J=null;if(null===u){return;}d.events.removeListener(u);u=null;}function F(){window.clearTimeout(s);s=null;}function n(){var am=U;U=H;H=am;}function ad(ao){if(typeof ao!=="number"||0>=ao||ao>p.length){return;}var an=W();var am=(ao-1)%p.length;z();if(bbc.fmtj.utils.prefixUrl(p[am].src)!==bbc.fmtj.utils.prefixUrl(U.get("img").attr("src"))){if(U.get("img").attr("src")!==bbc.fmtj.utils.prefixUrl(p[am].src)){U.get("img").attr("src",k).attr("alt","");U.get("img").attr("src",bbc.fmtj.utils.prefixUrl(p[am].src)).attr("alt",p[am].alt);}}A(am);U.css("z-index",1).css("opacity",1);H.css("z-index",0).css("opacity",0);am=(++am%p.length);if(bbc.fmtj.utils.prefixUrl(p[am].src)!==bbc.fmtj.utils.prefixUrl(H.get("img").attr("src"))){H.get("img").attr("src",bbc.fmtj.utils.prefixUrl(p[am].src)).attr("alt",p[am].alt);}x=ao%p.length;n();}function t(am){ad(am);if(!ai){M();}}function K(am){}function T(){var am=W().empty();am.addClass("slideshow");var an=bbc.fmtj.utils.prefixUrl(p[x].src);var ao=(G().get("img").length?G().html():d.lang.interpolate('<img src="'+an+'" alt="{alt}"/>',p[x]));H=d.dom.create("<div>"+ao+"</div>");H.addClass("pic0").css("position","absolute").css("z-index","1").width(Y).css("text-align","center").get("img").css("margin-left","auto").css("margin-right","auto").css("display","block");H.get("img").attr("galleryimg","no");am.append(H);++x;U=d.dom.create("<div>"+ao+"</div>");U.addClass("pic1").css("position","absolute").css("z-index","0").css("opacity",0).width(Y).css("text-align","center").get("img").css("margin-left","auto").css("margin-right","auto").css("display","block").attr("src",bbc.fmtj.utils.prefixUrl(p[x].src)).attr("alt",p[x].alt);U.get("img").attr("galleryimg","no");am.append(U);am.height(Z).width(Y).css("overflow","hidden").css("position","relative");if(I){ak(r,d);}}function y(){var ar=0;var an=1;var ao=2;var ap=3;var aq=[];aq[ar]={src:"http://newsimg.bbc.co.uk/shared/img/slideshow/left_arrow.gif",alt:a.PREVIOUS_IMAGE};aq[an]={src:"http://newsimg.bbc.co.uk/shared/img/slideshow/right_arrow.gif",alt:a.NEXT_IMAGE};aq[ao]={src:"http://newsimg.bbc.co.uk/shared/img/slideshow/pause.gif",alt:a.PAUSE};aq[ap]={src:"http://newsimg.bbc.co.uk/shared/img/slideshow/play.gif",alt:a.START};var am=W();am.append('<div class="mask" style="top:'+Z+'px"></div>');am.get(".mask").css("opacity",0.5).width(Y).height(O);am.append('<div class="nav" style="top:'+(Z-O)+'px;" />');am.get(".nav").append('<div class="controls"></div>');am.get(".nav div.controls").append('<a class="previous" title="'+aq[ar].alt+'"><span>'+aq[ar].alt+"</span></a>");am.get(".nav div.controls").append('<span class="separator"> | </span>');if(ab){am.get(".nav div.controls").append('<a class="playpause_button pause" title="'+aq[ao].alt+'"><span>'+aq[ao].alt+"</span></a>");}else{am.get(".nav div.controls").append('<a class="playpause_button play" title="'+aq[ap].alt+'"><span>'+aq[ap].alt+"</span></a>");}am.get(".nav div.controls").append('<span class="separator"> | </span>');am.get(".nav div.controls").append('<a class="next" title="'+aq[an].alt+'"><span>'+aq[an].alt+"</span></a>");am.get(".nav").append('<div class="imageposition">1 / '+p.length+"</div>");am.get(".nav a").css("opacity",0.7);d.events.addListener(r,"slideChange",function(av){var at=av.currentImageIndex;var au=at+1;am.get(".nav .imageposition").text(au+" / "+p.length);});d.events.addListener(am,"mouseover",function(){window.clearTimeout(s);s=null;d.anim.css(am.get(".mask"),0.3,{top:{to:Z-O}},d.tweens.easeOut(2)).start();d.anim.css(am.get(".nav"),0.3,{top:{to:Z-(2*O)}},d.tweens.easeOut(2)).start();});d.events.addListener(am,"mouseout",function(){s=window.setTimeout(function(){d.anim.css(am.get(".mask"),0.3,{top:{to:Z}},d.tweens.easeOut(2)).start();d.anim.css(am.get(".nav"),0.3,{top:{to:Z-O}},d.tweens.easeOut(2)).start();},aa);});d.events.addListener(am.get(".nav a"),"mouseover",function(){d.dom.get(this).css("opacity",1);});d.events.addListener(am.get(".nav a"),"mouseout",function(){d.dom.get(this).css("opacity",0.7);});d.events.addListener(am.get(".nav a.previous"),"click",function(){t(E());});d.events.addListener(am.get(".nav a.next"),"click",function(){t(al());});d.events.addListener(am.get(".nav a.playpause_button"),"click",function(){var at=d.dom.get(this);if(!ai){at.removeClass("pause");at.addClass("play");at.attr("title",aq[ap].alt);at.get("span").text("Play");l();return;}at.removeClass("play");at.addClass("pause");at.attr("title",aq[ao].alt);at.get("span").text("Pause");M({interval:0.5});});}function ag(){if(p.length<g){return;}var am=new Image;am.src=k;K(p);T();if(ab){M();}}}})();bbc.fmtj.apps.slideshow.isReady=true;bbc.fmtj.queue.callback("bbc.fmtj.apps.slideshow.createSlideShow");}});